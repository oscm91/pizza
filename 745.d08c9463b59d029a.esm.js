"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[745],{MVcp:(e,t,a)=>{a.r(t),a.d(t,{actions:()=>I,facade:()=>N,getStore:()=>U});var n=a("0Rih"),r=a("V8Kl"),s=a("UA8S");function c(e){return({dispatch:t,getState:a})=>n=>r=>"function"==typeof r&&r.worker?r(t,a,e):n(r)}c((()=>{}));var i=a("cYqW");const o=new function(){return new Worker(a.p+"workerReducer.worker.489d0ddd7cffc2f9.esm.worker.js")};let d=null,p=!1;const u=async function(){return d||p||(p=!0,d=await(0,i.Ud)(o)),new Promise((e=>{setTimeout((()=>{e(d)}),0)}))},m="@@PAYMENTS/TABLE/FORMAT",l="@@PAYMENTS/TABLE/FILTER",y="@@PAYMENTS/TABLE/UPDATE",g="@@PRODUCTS/ADD/INGREDIENT",f="@@PRODUCTS/REMOVE/INGREDIENT",O="@@PRODUCTS/ADD/MASS",w="@@PRODUCTS/REMOVE/MASS",S="@@PRODUCTS/SET/NAME",b="@@PRODUCTS/UPDATE",x="@@PRODUCTS/SAVE",T={data:[],normalized:[],filtered:[]},j={ingredients:[{name:"Pollo",price:5e3},{name:"Peperoni",price:4500},{name:"Maiz",price:3e3},{name:"Tomate",price:3e3},{name:"Aj\xed",price:3e3},{name:"Maduro",price:3e3},{name:"Champi\xf1ones",price:3e3},{name:"Carne de res",price:3e3},{name:"Aguacate",price:3e3},{name:"Cebolla",price:3e3},{name:"Jam\xf3n",price:3e3},{name:"Queso",price:3e3},{name:"Anchoas",price:3e3},{name:"Salm\xf3n",price:3e3},{name:"Esp\xe1rragos",price:3e3},{name:"habichuela",price:3e3}],mass:[{name:"Base de harina",price:1e4},{name:"Base de avena",price:15e3}],product:{name:"",ingredients:[],mass:void 0,price:0,resume:[],isCompleted:!1},list:[]},E=(e,t)=>(e&&e.price||0)+(t&&t.length?t.reduce(((e,t)=>e+(t.price||0)),0):0),h=(e,t)=>{const a=[];if(e&&a.push(Object.assign({},e,{type:"mass",quantity:1})),t&&t.length){const e=t.reduce(((e,t)=>{const a=e[t.name]||{};return Object.assign({},e,{[t.name]:Object.assign({},t,{price:(a.price||0)+t.price,type:"ingredient",quantity:(a.quantity||0)+1})})}),{});a.push(...Object.values(e))}return a},P=(e,t,a)=>!!(e&&t&&a&&a.length),A=(0,n.UY)({payments:(e=T,{type:t,payload:a})=>{switch(t){case m:{const t=Object.values(a.payments).map((e=>Object.assign({},e,{date:e.created_date,amount:`$${e.payment_value}`,deductions:`-$${e.payment_due}`})));return Object.assign({},e,{data:a.payments,normalized:t})}case l:return!a.filters.length||a.filters.includes("all")?Object.assign({},e,{filtered:a.payments}):Object.assign({},e,{filtered:a.payments.filter((e=>a.filters.includes(e.payment_type)))});case y:return Object.assign({},e,a);default:return e}},products:(e=j,{type:t,payload:a})=>{switch(t){case S:return Object.assign({},e,{product:Object.assign({},e.product,{name:a,isCompleted:P(a,e.product.mass,e.product.ingredients)})});case O:{const t=a,n=e.mass.find((e=>e.name===t));return Object.assign({},e,{product:Object.assign({},e.product,{mass:n,price:E(n,e.product.ingredients),resume:h(n,e.product.ingredients),isCompleted:P(e.product.name,n,e.product.ingredients)})})}case w:{const t=void 0;return Object.assign({},e,{product:Object.assign({},e.product,{mass:t,price:E(t,e.product.ingredients),resume:h(t,e.product.ingredients),isCompleted:P(e.product.name,t,e.product.ingredients)})})}case g:{const t=a,n=e.ingredients.find((e=>e.name===t)),r=[].concat(e.product.ingredients,n);return Object.assign({},e,{product:Object.assign({},e.product,{ingredients:r,price:E(e.product.mass,r),resume:h(e.product.mass,r),isCompleted:P(e.product.name,e.product.mass,r)})})}case f:{const t=a,n=e.ingredients.find((e=>e.name===t));let r=!1;const s=e.product.ingredients.filter((e=>!(e.name===n.name&&!r)||(r=!0,!1)));return Object.assign({},e,{product:Object.assign({},e.product,{ingredients:s,price:E(e.product.mass,s),resume:h(e.product.mass,s),isCompleted:P(e.product.name,e.product.mass,s)})})}case x:return Object.assign({},e,{list:Object.assign({},e.list,{[e.product.name]:e.product}),product:j.product});case b:return Object.assign({},a);default:return e}}}),C=(e,t)=>A(e,t);var D=a("ERkP"),_=a("tPIx");const k=(e,t)=>{const a=async(a,n,r)=>{a({type:y,payload:{data:[],normalized:[],filtered:[]}});const s=await r(),c=await s(n(),{type:m,payload:{payments:e}}),i=await s(c,{type:l,payload:{payments:c.payments.normalized,filters:t}});a({type:y,payload:i.payments})};return a.worker=!0,a},M=(e,t)=>{const a=async(a,n,r)=>{a({type:y,payload:Object.assign({},e,{filtered:[]})});const s=await r(),c=await s(n(),{type:l,payload:{payments:e,filters:t}});a({type:y,payload:c.payments})};return a.worker=!0,a};function v(){let e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){const a=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?a:3&a|8).toString(16)}))}const R=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||n.qC;function U(e){return(0,n.MT)(C,e,R((0,n.md)((0,s.a1)(),c(u),r.Z)))}const I={paymentsTableFormat:k,paymentsTableFilter:M},N={paymentsFacade:()=>{const e=(0,_.v9)((e=>Object.assign({},e.payments,{list:e.products.list}))),t=(0,_.I0)(),[a,n]=(0,D.useState)("today"),[r,s]=(0,D.useState)([]),[c,i]=(0,D.useState)([]),[o,d]=(0,D.useState)(""),[p,u]=(0,D.useState)("");return{getSearch:()=>a,setSearch:e=>n(e),checkFilter:e=>r.includes(e),setFilters:(e,t)=>{s(t?Array.from(new Set([].concat(e,r))):Array.from(new Set([].concat(e,r))).filter((t=>t!==e)))},getData:e=>{t(((e,t)=>async(a,n)=>{const r=n().payments.data;a({type:y,payload:{data:[],normalized:[],filtered:[]}});const s=await new Promise((t=>{setTimeout((()=>{"today"===e&&t(r),"week"===e&&t(r),"september"===e&&t(r)}),100)}));a({type:y,payload:{data:s,normalized:[],filtered:[]}});const c=n().payments.data;a(k(c,t))})(e,r))},filter:()=>{t(M(e.normalized,r))},getState:()=>e,getTotal:()=>c,setTotal:()=>i,buyer:o,product:p,setBuyer:d,setProduct:u,total:(e.data||[]).reduce(((e,t)=>e+(t.payment_value||0)),0),sellProduct:()=>{o&&p&&(t(((e,t)=>async(a,n)=>{const r=n(),s=[].concat(r.payments.data,e);a({type:y,payload:{data:s,normalized:[],filtered:[]}}),a(k(s,t))})({id:"fake-id-"+v(),created_date:(new Date).toISOString(),transaction_name:o,transaction_id:v(),payment_status:"started",payment_type:p,payment_method:"**** **** **** 7711",payment_value:e.list[p].price,payment_due:0},r)),d(""),u(""))}}},productsFacade:()=>{const e=(0,_.v9)((e=>e.products)),t=(0,_.I0)();return{removeIngredient:e=>{t((e=>{const t=async(t,a,n)=>{const r=await n(),s=await r(a(),{type:f,payload:e});t({type:b,payload:s.products})};return t.worker=!0,t})(e))},addIngredient:e=>{t((e=>{const t=async(t,a,n)=>{const r=await n(),s=await r(a(),{type:g,payload:e});t({type:b,payload:s.products})};return t.worker=!0,t})(e))},removeMass:e=>{t((e=>{const t=async(t,a,n)=>{const r=await n(),s=await r(a(),{type:w,payload:e});t({type:b,payload:s.products})};return t.worker=!0,t})(e))},addMass:e=>{t((e=>{const t=async(t,a,n)=>{const r=await n(),s=await r(a(),{type:O,payload:e});t({type:b,payload:s.products})};return t.worker=!0,t})(e))},setName:e=>{t((e=>async(t,a)=>{t({type:S,payload:e})})(e))},saveProduct:()=>{t((async(e,t)=>{e({type:x,payload:void 0})}))},getState:()=>e}}}}}]);